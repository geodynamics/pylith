<?xml version="1.0"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
  "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd">
<chapter id="tutorialbm5">
  <title>Tutorial Using SCEC Benchmark 5</title>

  <sect1>
    <title>Overview</title>
    <para>
      This tutorial walks the user through the steps necessary to
      construct, run, and view the results of a benchmark problem
      (SCEC Bemchmark 5). This problem examines the viscoelatic
      (Maxwell) relaxation of stress from a single, finite, dip-slip
      earthquake in 3-D without body forces. 
    </para>
  </sect1>

  <sect2>
    <title>Problem Description</title>
    <para>
      The model domain is a cube with edges 24 km long (0 km &le; x
      &le; 24 km; 0 km &le; y &le; 24 km; -24 km &le; z &le; 0) and is
      composed of two materials. One material occupies the top-half of
      the domain -12 km &le; z &le; 0km while the other occupies the
      lower half, -24km &le; z &lt; 12 km. Both materials are Poisson
      solids with Lame's constants (mu and lambda) equal to 30 GPa
      with Maxwell viscoelastic properties. The top layer has a
      viscosity of 10<superscript>25</superscript> Pa-s (and is
      essentially elastic) while the bottom layer has a viscosity of
      10<superscript>18</superscript> Pa-s.
    </para>
    <para>
      The reverse fault dips at an angle 45 degrees. The top of the
      fault sits at x = 4 km with the bottom of the fault at x =
      20 km. The fault surface is confined to the region 0 km &le; y &le;
      16 km and -16 km &le; z &le; 0 km. The slip distribution is 1.0 m of
      uniform thrust motion for -12 km &le; z with a linear taper to 0
      at z = -16 km.
    </para>
    <para>
      The boundary conditions on the lateral and bottom edges of the
      mesh are the displacements from the analytical elastic
      solution. These displacements are held fixed through time.
    </para>

    <para>
      INSERT FIGURE HERE
    </para>

  </sect2>
  <sect2>
    <title>Prerequisites</title>
    <para>
      You should have already installed PyLith-0.8. In this tutorial
      we assume that you are using <ulink
      url="http://www.hpfem.jku.at/netgen/">NetGen</ulink> to generate
      the mesh and <ulink url="http://www.paraview.org">
      ParaView</ulink> to view simulation results. You may use other
      packages, but some adaption from what is described here will
      be necessary.
    </para>
  </sect2>

  <sect1>
    <title>Stage 1: Download and setup</title>
    <para>
      Download the tutorial and setup the utilities used to transform
      NetGen output into PyLith-0.8 input.
    </para>

    <orderedlist numeration="arabic">
      <listitem>
	<para>
          Download the <ulink
          url="http://www.geodynamics.org:8080/cig/Members/willic3/pylithusers/lithomopinstallation/downloads/unworked_benchmarks.tar.gz">tutorial
          tarball</ulink> and unpack it in a location of your
          choosing. You may also wish to download the <ulink
          url="http://www.geodynamics.org:8080/cig/Members/willic3/pylithusers/lithomopinstallation/downloads/worked_benchmarks.tar.gz">worked
          example tarball</ulink> to compare your results or start at
          an intermediate step.
        </para>
      </listitem>
      <listitem>
	<para>
          Once you have unpacked the tarball, you will have an
          "unworked_benchmarks" directory.  Go to the "utils"
          sub-directory and edit the makefile as appropriate (it is
          presently setup for g77). You will need to make the
          following executables in order to generate the inputs files
          for PyLith-0.8 from NetGen output.
        </para>
	<variablelist>
	  <varlistentry>
	    <term>readnetgen</term>
	    <listitem>
	      <para>
                A fortran program to read NetGen neutral format and
                create several of the input files needed by
                PyLith-0.8.
              </para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>faultcalc</term>
	    <listitem>
	      <para>
                A fortran program to compute spit node displacements
                using equations of second degree over specified
                regions.
              </para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term>scalecoord</term>
	    <listitem>
	      <para>
                A very simple fortran program to scale nodal coordinates.
              </para>
	    </listitem>
	  </varlistentry>
	</variablelist>
      </listitem>
      <listitem>
	<para>
  	  Once you have built these utilities, move them to a location
  	  in your PATH or update your PATH to include the directory
  	  that contains them.
        </para>
      </listitem>
    </orderedlist>
  </sect1>

  <sect1>
    <title>Stage 2: Create simulation input files</title>
    <para>
      Generate the finite-element mesh and setup the input files for
      the mesh and boundary conditions.
    </para>
    
    <orderedlist numeration="arabic">
      <listitem>
	<para>
          All of the mesh generation tasks will be performed in the
          "meshgen" directory. The meshgen directory contains a file
          "bm5.geo", which is an input file for NetGen. Examine this
          file to see how the geometry is defined. Notice that thee
          different planes have been flagged with different boundary
          condition codes. These will be used to associate boundary
          conditions with surfaces and element faces and nodes.
        </para>
        <para>
          Start ...
        </para>
      </listitem>
    </orderedlist>
  </sect1>
</chapter>
