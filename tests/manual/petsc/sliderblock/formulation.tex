\documentclass{article}

\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{bm}

\newcommand{\trialvec}[1][]{{\vec{\psi}_\mathit{trial}^{#1}}}
\newcommand{\trialscalar}[1][]{{\psi_\mathit{trial}^{#1}}}
\newcommand{\basisvec}[1][]{{\vec{\psi}_\mathit{basis}^{#1}}}
\newcommand{\basisscalar}[1][]{{\psi_\mathit{basis}^{#1}}}

\newcommand{\tensor}[1]{\bm{#1}}

\begin{document}

\section{Prescribed Slip}

We apply conservation of momemtum,
\begin{equation}
  \int_\Omega \rho(\vec{x}) \frac{\partial \vec{v}}{\partial t} \, d\Omega = \int_\Omega \vec{f}(\vec{x},t) \, d\Omega + \int_\Gamma \vec{\tau}(\vec{x},t) \, d\Gamma,
\end{equation}
to a fault interface $\Omega_f$ with boundaries $\Gamma_{f^+}$ and $\Gamma_{f^-}$.
For a fault interface, the body force is zero ($\vec{f}(\vec{x},t) = \vec{0}$).
The tractions on the positive and negative fault faces are
\begin{gather}
  \tau^+(\vec{x},t) = \tensor{\sigma}^+ \cdot \vec{n} + \vec{\lambda} \\
  \tau^-(\vec{x},t) = \tensor{\sigma}^- \cdot \vec{n} - \vec{\lambda},
\end{gather}
where $\vec{\lambda}$ is the Lagrange multiplier that corresponds to the fault traction generating the prescribed slip.
Thus, for a fault interface, we have
\begin{equation}
  \int_{\Omega_f} \rho(\vec{x}) \frac{\partial \vec{v}}{\partial t} \, d\Omega = \int_{\Gamma_{f^+}} \tensor{\sigma} \cdot \vec{n} + \vec{\lambda} \, d\Gamma + \int_{\Gamma_{f^-}} \tensor{\sigma} \cdot \vec{n} - \vec{\lambda} \, d\Gamma.
\end{equation}

\subsection{Quasistatic Prescribed Slip}

In the quasistatic case we neglect inertia, so we have
\begin{equation}
  \int_{\Gamma_{f^+}} \tensor{\sigma} \cdot \vec{n} + \vec{\lambda} \, d\Gamma + \int_{\Gamma_{f^-}} \tensor{\sigma} \cdot \vec{n} - \vec{\lambda} \, d\Gamma = 0.
\end{equation}
We enforce this equation on each portion of the fault interface along with our prescribed slip constraint, which leads to
\begin{gather}
  \tensor{\sigma} \cdot \vec{n} + \vec{\lambda} = \vec{0} \text{ on } \Gamma_{f^+}, \\
  \tensor{\sigma} \cdot \vec{n} - \vec{\lambda} = \vec{0}\text{ on } \Gamma_{f^-}, \\
  \vec{u}^+ - \vec{u}^- - \vec{d} = \vec{0},  
\end{gather}


\section{Dynamic Prescribed Slip}

When we integrate the weak form of the momentum equation in the dynamic case, we select numerical quadrature that yields a lumped mass matrix.
That is, we have
\begin{equation}
  \int_\Omega \trialvec[v] \cdot \rho(\vec{x}) \frac{\partial \vec{v}}{\partial t} \, d\Omega = M_v \frac{\partial \vec{v}}{\partial t},
\end{equation}
where $M_v$ is the lumped mass matrix.
We can separate the integration of the weak form for negative and positive sides of the fault interface, which yields
\begin{gather}
  M_{v^+} \frac{\partial \vec{v}^+}{\partial t} = \int_{\Gamma_{f^+}} \trialvec[\lambda] \cdot \left( \tensor{\sigma} \cdot \vec{n} + \vec{\lambda} \right) \, d\Gamma, \\
  M_{v^-} \frac{\partial \vec{v}^-}{\partial t} = \int_{\Gamma_{f^-}} \trialvec[\lambda] \cdot \left( \tensor{\sigma} \cdot \vec{n} - \vec{\lambda} \right) \, d\Gamma.
\end{gather}

Our constraint for prescribed slip is
\begin{equation}
  \vec{u}^+ - \vec{u}^- - \vec{d} = \vec{0},
\end{equation}
where $\vec{u}$ is the displacement vector and $\vec{d}$ is the slip vector.
In order to match the order of the time derivative in the elasticity equation, we take the second derivative of the prescribed slip equation,
\begin{equation}
  \frac{\partial \vec{v}^+}{\partial t} - \frac{\partial \vec{v}^-}{\partial t} - \frac{\partial^2 \vec{d}}{\partial t^2} = \vec{0}.
\end{equation}
We form the weak form in the usual way,
\begin{equation}
  \int_{\Gamma_f} \trialvec[\lambda] \cdot \left( \frac{\partial \vec{v}^+}{\partial t} - \frac{\partial \vec{v}^-}{\partial t} - \frac{\partial^2 \vec{d}}{\partial t^2} \right) \, d\Gamma = 0.
\end{equation}
Substituting in the expressions for the time derivative of the velocity on the negative and positive sides of the fault using the weak form of our conservation of momemtum yields
\begin{equation}
M_{v^+}^{-1} \int_{\Gamma_f^+} \trialvec[\lambda] \cdot \left(\tensor{\sigma} \cdot \vec{n} + \vec{\lambda}\right) \, d\Gamma + M_{v^-}^{-1} \int_{\Gamma_f^-} \trialvec[\lambda] \cdot \left( -\tensor{\sigma} \cdot \vec{n} + \vec{\lambda} \right) \, d\Gamma - \int_{\Gamma_f} \trialvec[\lambda] \cdot \frac{\partial^2 \vec{d}}{\partial t^2} \, d\Gamma = \vec{0}.
\end{equation}

\end{document}
